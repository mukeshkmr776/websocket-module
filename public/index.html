<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hi</title>
</head>

<body>

    Hello world.
    <br>
    See Console in Chrome Debugging Tool, and then load page.


    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <!-- <script src='https://cdnjs.cloudflare.com/ajax/libs/socket.io/3.0.3/socket.io.min.js'></script> -->
    <script src="/socket.io/socket.io.js"></script>
    <script>
        window.onload = function onLoad() {
            const socket = io({
                path: '/ws'
            });

            socket.on('connect', () => {
                console.log('SocketConnected!');
                onConnect();
            });
            socket.on('disconnect', () => {
                console.log('Socket Disonnected!');
            });
            socket.on('reconnect', () => {
                console.log('Socket Reconnected!');
            });
            socket.on('error', (error) => {
                console.log('Socket Error - ', error);
            });
            socket.on('message', (data) => {
                console.log('message received from server - ', data);
            });

            async function onConnect() {
                // await fetch('/broadcast').catch(error => console.log(error));
                const data = {
                    type: 'MYKEY',
                    message: 'Hello World'
                }
                socket.emit('message', data);
            }

        }
    </script>

</body>

</html>