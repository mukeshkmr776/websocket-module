<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hi</title>
</head>

<body>

    Hello world


    <script src='https://cdnjs.cloudflare.com/ajax/libs/socket.io/3.0.3/socket.io.min.js'></script>
    <script>
        window.onload = function onLoad() {
            const socket = io({path: '/ws'});

            socket.on('connect', () => {
                console.log('SocketConnected!');
                onConnect();
            });
            socket.on('disconnect', () => {
                console.log('Socket Disonnected!');
            });
            socket.on('reconnect', () => {
                console.log('Socket Reconnected!');
            });
            socket.on('error', (error) => {
                console.log('Socket Error - ', error);
            });
            socket.on('message', (data) => {
                console.log('message received from server - ', data);
            });

            async function onConnect() {
                // await fetch('/broadcast').catch(error => console.log(error));
                socket.emit('message', {type: 'MYKEY', message: {hello: 'world MYKEY'}});
            }

        }
    </script>

</body>

</html>